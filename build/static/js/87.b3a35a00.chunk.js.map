{"version":3,"file":"static/js/87.b3a35a00.chunk.js","mappings":"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","sources":["views/CBM.js"],"sourcesContent":["import React, { useState, useEffect } from 'react'\r\nimport axios from 'axios'\r\nimport { NavLink } from 'react-router-dom'\r\nimport { CTable, CTableHead, CButton } from '@coreui/react'\r\nimport { MdDelete } from 'react-icons/md'\r\nimport './assetTable/asset.css'\r\nimport { FaEdit } from 'react-icons/fa'\r\nimport { Table, Thead, Tbody, Tr, Th, Td } from 'react-super-responsive-table'\r\nimport 'react-super-responsive-table/dist/SuperResponsiveTableStyle.css'\r\n\r\nconst AssetTable = () => {\r\n  const [cbms, setCbms] = useState([])\r\n  const [filteredCbms, setFilteredCbms] = useState([])\r\n  const [searchQuery, setSearchQuery] = useState('')\r\n  const [message, setMessage] = useState('')\r\n  const [loading, setLoading] = useState(true)\r\n  const [scannedData, setScannedData] = useState(null)\r\n\r\n  useEffect(() => {\r\n    axios\r\n      .get('https://backendmaintenx.onrender.com/api/cbm')\r\n      .then((response) => {\r\n        const cbmData = Array.isArray(response.data) ? response.data : [response.data]\r\n        setCbms(cbmData)\r\n        setFilteredCbms(cbmData)\r\n        setLoading(false)\r\n      })\r\n      .catch((error) => {\r\n        console.error('Error fetching data:', error)\r\n        alert('Error fetching data')\r\n        setLoading(false)\r\n      })\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    const updateNextDate = async () => {\r\n      const today = new Date()\r\n      const updatedAssets = await Promise.all(\r\n        cbms.map(async (cbm) => {\r\n          const nextDate = new Date(cbm.nextCbmDate)\r\n          if (today >= nextDate) {\r\n            let daysToAdd = 1\r\n            switch (cbm.cbmFrequency.toLowerCase()) {\r\n              case 'daily':\r\n                daysToAdd = 1\r\n                break\r\n              case 'weekly':\r\n                daysToAdd = 7\r\n                break\r\n              case 'fifteen days':\r\n                daysToAdd = 15\r\n                break\r\n              case 'monthly':\r\n                daysToAdd = 30\r\n                break\r\n              case 'quarterly':\r\n                daysToAdd = 90\r\n                break\r\n              case 'half year':\r\n                daysToAdd = 180\r\n                break\r\n              case 'yearly':\r\n                daysToAdd = 365\r\n                break\r\n              default:\r\n                daysToAdd = 1\r\n            }\r\n            nextDate.setDate(nextDate.getDate() + daysToAdd)\r\n            cbm.nextCbmDate = nextDate.toISOString().split('T')[0]\r\n            cbm.status = 'Pending'\r\n          }\r\n          return cbm\r\n        }),\r\n      )\r\n      setCbms(updatedAssets)\r\n      setFilteredCbms(updatedAssets)\r\n      try {\r\n        await axios.put('https://backendmaintenx.onrender.com/api/cbmupdateRecords', {\r\n          cbms: updatedAssets,\r\n        })\r\n      } catch (error) {\r\n        console.error('Error updating Next Date in the database:', error)\r\n      }\r\n    }\r\n\r\n    const scheduleUpdate = () => {\r\n      const now = new Date()\r\n      const nextUpdate = new Date(\r\n        now.getFullYear(),\r\n        now.getMonth(),\r\n        now.getDate(),\r\n        14,\r\n        31,\r\n        0,\r\n        0, // Set to 11:30 PM\r\n      )\r\n\r\n      // If 11:30 PM has already passed for today, schedule for tomorrow\r\n      if (now >= nextUpdate) {\r\n        nextUpdate.setDate(nextUpdate.getDate() + 1)\r\n      }\r\n\r\n      const timeToNextUpdate = nextUpdate - now\r\n\r\n      setTimeout(() => {\r\n        updateNextDate()\r\n        setInterval(updateNextDate, 24 * 60 * 60 * 1000) // Run every 24 hours\r\n      }, timeToNextUpdate)\r\n    }\r\n\r\n    scheduleUpdate()\r\n  }, [cbms])\r\n\r\n  const deleteData = (id) => {\r\n    const isConfirmed = window.confirm('Are you sure you want to delete this data?')\r\n    if (isConfirmed) {\r\n      axios\r\n        .delete(`https://backendmaintenx.onrender.com/api/cbm/${id}`)\r\n        .then((response) => {\r\n          const newCbms = cbms.filter((cbm) => cbm._id !== id)\r\n          setCbms(newCbms)\r\n          setFilteredCbms(newCbms)\r\n          setMessage('Data successfully deleted!')\r\n          setTimeout(() => {\r\n            setMessage('')\r\n          }, 2000)\r\n        })\r\n        .catch((error) => {\r\n          console.error('Error deleting data:', error)\r\n          setMessage('Error deleting data. Please try again.')\r\n          setTimeout(() => {\r\n            setMessage('')\r\n          }, 2000)\r\n        })\r\n    }\r\n  }\r\n\r\n  const handleSearchChange = (e) => {\r\n    const query = e.target.value.toLowerCase()\r\n    const filteredCbms = cbms.filter((cbm) => {\r\n      const locationLower = (cbm.location || '').toLowerCase()\r\n      const assetNameLower = (cbm.assetName || '').toLowerCase()\r\n      return locationLower.includes(query) || assetNameLower.includes(query)\r\n    })\r\n    setFilteredCbms(filteredCbms)\r\n    setSearchQuery(query)\r\n  }\r\n\r\n  const handleScan = (data) => {\r\n    if (data) {\r\n      setScannedData(data)\r\n    }\r\n  }\r\n\r\n  const handleError = (err) => {\r\n    console.error(err)\r\n  }\r\n\r\n  return (\r\n    <div className=\"container\">\r\n      <NavLink to=\"/cbmForm\">\r\n        <CButton className=\"mb-2\" style={{ marginTop: '5px', backgroundColor: '#000026' }}>\r\n          Add New\r\n        </CButton>\r\n      </NavLink>\r\n      <label htmlFor=\"searchTask\" style={{ marginLeft: '70%' }}>\r\n        <span role=\"img\" aria-label=\"search-icon\"></span>\r\n      </label>\r\n      <input\r\n        placeholder=\"Search by Asset/Location\"\r\n        style={{\r\n          marginBottom: '10px',\r\n          padding: '8px',\r\n          border: '1px solid ',\r\n          borderRadius: '4px',\r\n          transition: 'border-color 0.3s ease-in-out, background-color 0.3s ease-in-out',\r\n        }}\r\n        value={searchQuery}\r\n        onChange={handleSearchChange}\r\n      />\r\n      <div className=\"table-container\">\r\n        <Table className=\"custom-table\">\r\n          <Thead>\r\n            <Tr>\r\n              <Th>Sr No</Th>\r\n              <Th>Asset Name</Th>\r\n              <Th>Location</Th>\r\n              {/* <Th style={{ textAlign: 'center' }}>Installation Date</Th> */}\r\n              <Th>CBM Schedule Date</Th>\r\n              <Th></Th>\r\n              <Th>CBM Frequency</Th>\r\n              <Th>Next CBM</Th>\r\n              <Th>Status</Th>\r\n              <Th>Edit</Th>\r\n              <Th>Delete</Th>\r\n            </Tr>\r\n          </Thead>\r\n          <Tbody>\r\n            {loading ? (\r\n              <tr>\r\n                <td colSpan=\"12\" style={{ textAlign: 'center' }}>\r\n                  <p>Loading...</p>\r\n                </td>\r\n              </tr>\r\n            ) : (\r\n              <>\r\n                {message && (\r\n                  <tr>\r\n                    <td\r\n                      colSpan=\"12\"\r\n                      style={{ textAlign: 'center', fontStyle: 'italic', color: 'red' }}\r\n                    >\r\n                      {message}\r\n                    </td>\r\n                  </tr>\r\n                )}\r\n                {filteredCbms.map((cbm, index) => (\r\n                  <Tr key={cbm._id}>\r\n                    <Td>{index + 1}</Td>\r\n                    <Td>{cbm.assetName}</Td>\r\n                    <Td>{cbm.location}</Td>\r\n                    {/* <Td style={{ textAlign: 'center' }}>\r\n                    {new Date(cbm.installationDate).toLocaleDateString()}\r\n                  </Td> */}\r\n                    <Td>{new Date(cbm.cbmScheduleDate).toLocaleDateString()}</Td>\r\n                    <Td></Td>\r\n                    <Td>{cbm.cbmFrequency}</Td>\r\n                    <Td>{new Date(cbm.nextCbmDate).toLocaleDateString()}</Td>\r\n                    <Td>{cbm.status}</Td>\r\n                    <Td>\r\n                      <NavLink to={`/editcbm/${cbm._id}`} style={{ color: '#000080' }}>\r\n                        <FaEdit />\r\n                      </NavLink>\r\n                    </Td>\r\n                    <Td>\r\n                      <button\r\n                        className=\"btn\"\r\n                        onClick={() => deleteData(cbm._id)}\r\n                        style={{ color: 'red' }}\r\n                      >\r\n                        <MdDelete />\r\n                      </button>\r\n                    </Td>\r\n                  </Tr>\r\n                ))}\r\n              </>\r\n            )}\r\n          </Tbody>\r\n        </Table>\r\n        <div>\r\n          {scannedData && (\r\n            <div>\r\n              <h3>Scanned Data:</h3>\r\n              <p>{scannedData}</p>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default AssetTable\r\n"],"names":["_useState","useState","_useState2","_slicedToArray","cbms","setCbms","_useState3","_useState4","filteredCbms","setFilteredCbms","_useState5","_useState6","searchQuery","setSearchQuery","_useState7","_useState8","message","setMessage","_useState9","_useState10","loading","setLoading","_useState11","_useState12","scannedData","useEffect","axios","get","then","response","cbmData","Array","isArray","data","catch","error","console","alert","updateNextDate","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee2","today","updatedAssets","wrap","_context2","prev","next","Date","Promise","all","map","_ref2","_callee","cbm","nextDate","daysToAdd","_context","nextCbmDate","t0","cbmFrequency","toLowerCase","abrupt","setDate","getDate","toISOString","split","status","stop","_x","apply","arguments","sent","put","now","nextUpdate","getFullYear","getMonth","setTimeout","setInterval","scheduleUpdate","_jsxs","className","children","_jsx","NavLink","to","CButton","style","marginTop","backgroundColor","htmlFor","marginLeft","role","placeholder","marginBottom","padding","border","borderRadius","transition","value","onChange","e","query","target","filter","locationLower","location","assetNameLower","assetName","includes","Table","Thead","Tr","Th","Tbody","colSpan","textAlign","_Fragment","fontStyle","color","index","Td","cbmScheduleDate","toLocaleDateString","concat","_id","FaEdit","onClick","id","window","confirm","delete","newCbms","MdDelete"],"sourceRoot":""}