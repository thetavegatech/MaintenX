"use strict";(self.webpackChunk_coreui_coreui_free_react_admin_template=self.webpackChunk_coreui_coreui_free_react_admin_template||[]).push([[496],{22469:function(e,t,n){n.r(t);var r=n(74165),a=n(15861),s=n(29439),c=n(72791),i=n(55294),l=n(11087),o=n(78983),d=n(16856),u=n(56355),x=(n(8477),n(18512)),h=(n(66338),n(80184));t.default=function(){var e=(0,c.useState)([]),t=(0,s.Z)(e,2),n=t[0],p=t[1],m=(0,c.useState)([]),b=(0,s.Z)(m,2),f=b[0],g=b[1],y=(0,c.useState)(""),j=(0,s.Z)(y,2),T=j[0],A=j[1],k=(0,c.useState)(""),v=(0,s.Z)(k,2),D=v[0],w=v[1],S=(0,c.useState)(!0),Z=(0,s.Z)(S,2),_=Z[0],L=Z[1],N=(0,c.useState)(null),C=(0,s.Z)(N,2),E=C[0];C[1];(0,c.useEffect)((function(){i.Z.get("https://backendmaintenx.onrender.com/api/tbm").then((function(e){var t=Array.isArray(e.data)?e.data:[e.data];p(t),g(t),L(!1)})).catch((function(e){console.error("Error fetching data:",e),alert("Error fetching data"),L(!1)}))}),[]),(0,c.useEffect)((function(){var e=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){var t,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Date,e.next=3,Promise.all(n.map(function(){var e=(0,a.Z)((0,r.Z)().mark((function e(n){var a,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=new Date(n.nextTbmDate),!(t>=a)){e.next=24;break}s=1,e.t0=n.tbmFrequency.toLowerCase(),e.next="daily"===e.t0?6:"weekly"===e.t0?8:"fifteen days"===e.t0?10:"monthly"===e.t0?12:"quarterly"===e.t0?14:"half year"===e.t0?16:"yearly"===e.t0?18:20;break;case 6:return s=1,e.abrupt("break",21);case 8:return s=7,e.abrupt("break",21);case 10:return s=15,e.abrupt("break",21);case 12:return s=30,e.abrupt("break",21);case 14:return s=90,e.abrupt("break",21);case 16:return s=180,e.abrupt("break",21);case 18:return s=365,e.abrupt("break",21);case 20:s=1;case 21:a.setDate(a.getDate()+s),n.nextTbmDate=a.toISOString().split("T")[0],n.status="Pending";case 24:return e.abrupt("return",n);case 25:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 3:return s=e.sent,p(s),g(s),e.prev=6,e.next=9,i.Z.put("https://backendmaintenx.onrender.com/api/tbmupdateRecords",{tbms:s});case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(6),console.error("Error updating Next Date in the database:",e.t0);case 14:case"end":return e.stop()}}),e,null,[[6,11]])})));return function(){return e.apply(this,arguments)}}();!function(){var t=new Date,n=new Date(t.getFullYear(),t.getMonth(),t.getDate(),14,27,0,0);t>=n&&n.setDate(n.getDate()+1),setTimeout((function(){e(),setInterval(e,864e5)}),n-t)}()}),[n]);return(0,h.jsxs)("div",{className:"container",children:[(0,h.jsx)(l.OL,{to:"/tbmForm",children:(0,h.jsx)(o.u5,{className:"mb-2",style:{marginTop:"5px",backgroundColor:"#000026"},children:"Add New"})}),(0,h.jsx)("label",{htmlFor:"searchTask",style:{marginLeft:"70%"},children:(0,h.jsx)("span",{role:"img","aria-label":"search-icon"})}),(0,h.jsx)("input",{placeholder:"Search by Asset/Location",style:{marginBottom:"10px",padding:"8px",border:"1px solid ",borderRadius:"4px",transition:"border-color 0.3s ease-in-out, background-color 0.3s ease-in-out"},value:T,onChange:function(e){var t=e.target.value.toLowerCase(),r=n.filter((function(e){var n=(e.location||"").toLowerCase(),r=(e.assetName||"").toLowerCase();return n.includes(t)||r.includes(t)}));g(r),A(t)}}),(0,h.jsxs)("div",{className:"table-container",children:[(0,h.jsxs)(x.iA,{className:"custom-table",children:[(0,h.jsx)(x.hr,{style:{backgroundColor:"#000026",color:"white"},children:(0,h.jsxs)(x.Tr,{children:[(0,h.jsx)(x.Th,{style:{textAlign:"center",height:"40px"},children:"Sr No"}),(0,h.jsx)(x.Th,{style:{textAlign:"center"},children:"Asset Name"}),(0,h.jsx)(x.Th,{style:{textAlign:"center"},children:"Location"}),(0,h.jsx)(x.Th,{style:{textAlign:"center"},children:"TBM Schedule Date"}),(0,h.jsx)(x.Th,{}),(0,h.jsx)(x.Th,{style:{textAlign:"center"},children:"TBM Frequency"}),(0,h.jsx)(x.Th,{style:{textAlign:"center"},children:"Next TBM Date"}),(0,h.jsx)(x.Th,{style:{textAlign:"center"},children:"Status"}),(0,h.jsx)(x.Th,{style:{textAlign:"center"},children:"Edit"}),(0,h.jsx)(x.Th,{style:{textAlign:"center"},children:"Delete"})]})}),(0,h.jsx)(x.p3,{children:_?(0,h.jsx)("tr",{children:(0,h.jsx)("td",{colSpan:"12",style:{textAlign:"center"},children:(0,h.jsx)("p",{children:"Loading..."})})}):(0,h.jsxs)(h.Fragment,{children:[D&&(0,h.jsx)("tr",{children:(0,h.jsx)("td",{colSpan:"12",style:{textAlign:"center",fontStyle:"italic",color:"red"},children:D})}),f.map((function(e,t){return(0,h.jsxs)(x.Tr,{children:[(0,h.jsx)(x.Td,{style:{textAlign:"center"},children:t+1}),(0,h.jsx)(x.Td,{style:{textAlign:"center"},children:e.assetName}),(0,h.jsx)(x.Td,{style:{textAlign:"center"},children:e.location}),(0,h.jsx)(x.Td,{style:{textAlign:"center"},children:new Date(e.tbmScheduleDate).toLocaleDateString()}),(0,h.jsx)(x.Td,{}),(0,h.jsx)(x.Td,{style:{textAlign:"center"},children:e.tbmFrequency}),(0,h.jsx)(x.Td,{style:{textAlign:"center"},children:new Date(e.nextTbmDate).toLocaleDateString()}),(0,h.jsxs)(x.Td,{style:{textAlign:"center"},children:[e.status," "]}),(0,h.jsx)(x.Td,{style:{textAlign:"center"},children:(0,h.jsx)(l.OL,{to:"/edittbm/".concat(e._id),style:{color:"#000080"},children:(0,h.jsx)(u.fmQ,{})})}),(0,h.jsx)(x.Td,{style:{textAlign:"center"},children:(0,h.jsx)("button",{className:"btn",onClick:function(){return t=e._id,void(window.confirm("Are you sure you want to delete this data?")&&i.Z.delete("https://backendmaintenx.onrender.com/api/tbm/".concat(t)).then((function(e){var r=n.filter((function(e){return e._id!==t}));p(r),g(r),w("Data successfully deleted!"),setTimeout((function(){w("")}),2e3)})).catch((function(e){console.error("Error deleting data:",e),w("Error deleting data. Please try again."),setTimeout((function(){w("")}),2e3)})));var t},style:{color:"red"},children:(0,h.jsx)(d.ZkW,{})})})]},e._id)}))]})})]}),(0,h.jsx)("div",{children:E&&(0,h.jsxs)("div",{children:[(0,h.jsx)("h3",{children:"Scanned Data:"}),(0,h.jsx)("p",{children:E})]})})]})]})}},8477:function(){}}]);
//# sourceMappingURL=496.37ce4825.chunk.js.map